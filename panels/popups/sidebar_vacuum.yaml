---
action: fire-dom-event
browser_mod:
  command: popup
  title: Vacuum
  style:
    .: |
      :host .content {
        width: calc(385px + 510px);
        max-width: 90vw;
      }
    layout-card$grid-layout:
      $: |
        hui-vertical-stack-card {
          animation: border 1s forwards;
        }
        @keyframes border {
          0%, 100% {
              border-right: 1.5px solid rgba(0, 0, 0, 0.2);
          }
        }
        /* phone */
        @media screen and (max-width: 800px) {
          hui-vertical-stack-card {
              border-bottom: 1.5px solid rgba(0, 0, 0, 0.2);
              padding-right: 0;
              animation: none;
          }
        }
      $hui-vertical-stack-card:
        $: |
          hui-horizontal-stack-card {
            padding: 0em 2em 2.3em 2em;
          }
        $hui-entities-card$: |
          .card-content {
            padding: var(--card-content-padding);
          }
        $hui-horizontal-stack-card$: |
          #root {
            justify-content: space-evenly;
          }
  card:
    type: custom:layout-card
    layout_type: custom:grid-layout
    layout:
      grid-template-columns: 385px 510px
      grid-template-rows: 1fr
      grid-template-areas: |
        "info map"
      mediaquery:
        # phone
        "(max-width: 800px)":
          grid-template-columns: 1fr
          grid-template-rows: repeat(2, 1fr)
          grid-template-areas: |
            "info"
            "map"
    cards:

      # -----------
      # Information
      # -----------
      - type: vertical-stack
        view_layout:
          grid-area: info
        cards:
          - type: entities
            title: Settings
            card_mod:
              class: header
            entities:

              - entity: vacuum.roborock_s5_max

              - entity: sensor.template_vacuum_lastclean

              - type: custom:bar-card
                width: 55%
                height: 2em
                decimal: 0
                unit_of_measurement: '%'
                positions:
                  icon: outside
                  indicator: 'off'
                  name: outside
                severity:
                  - color: '#303435'
                    from: 11
                    to: 100
                  - color: '#6d2525'
                    from: 0
                    to: 10
                entity_row: true
                entities:

                  - entity: vacuum.roborock_s5_max
                    attribute: battery_level
                    name: Battery
                    icon: mdi:battery

                  - entity: sensor.template_vacuum_filter

                  - entity: sensor.template_vacuum_mainbrush

                  - entity: sensor.template_vacuum_sidebrush

                  - entity: sensor.template_vacuum_sensors

              - entity: select.vacuum_speed

          - type: horizontal-stack
            cards:

              - type: custom:button-card
                entity: vacuum.roborock_s5_max
                icon: mdi:play-pause
                tap_action:
                  action: call-service
                  service: >
                    [[[
                      return entity.state === 'docked' || entity.state === 'paused'
                        ? 'vacuum.start'
                        : 'vacuum.pause';
                    ]]]
                  service_data:
                    entity_id: >
                      [[[ return entity.entity_id; ]]]
                template: icon_only

              - type: custom:button-card
                entity: vacuum.roborock_s5_max
                icon: mdi:battery-charging
                tap_action:
                  action: call-service
                  service: vacuum.return_to_base
                  service_data:
                    entity_id: >
                      [[[ return entity.entity_id; ]]]
                template: icon_only

              - type: custom:button-card
                icon: mdi:delete-empty
                tap_action:
                  action: call-service
                  service: vacuum.send_command
                  service_data:
                    entity_id: vacuum.roborock_s5_max
                    command: app_goto_target
                    params: [27494, 23356]
                template: icon_only

      # ----
      # Map
      # ----
      - type: vertical-stack
        view_layout:
          grid-area: map
        cards:
          - type: entities
            title: Map
            card_mod:
              class: header
              style: |
                #states {
                  padding-bottom: 0;
                }
            entities:
              - type: custom:xiaomi-vacuum-map-card
                title: Map
                entity: vacuum.roborock_s5_max
                map_camera: camera.vacuum_map
                camera_calibration: true
                zones:
                  - [[30473, 22542, 33471, 28495]] # Alex's Room
                  - [[24895, 19420, 27226, 21876]] # Bathroom
                  - [[27643, 18795, 30598, 21959]] # Foyer
                  - [[26269, 22001, 30515, 24915]] # Kitchen
                  - [[21939, 25040, 29807, 29369]] # Living Room
                  - [[22106, 21876, 25644, 24790]] # Michael's Room
